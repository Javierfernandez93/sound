<?php define("TO_ROOT", "../../");set_time_limit(0);ini_set("memory_limit","1024M");header("Content-Type: application/json");header("Access-Control-Allow-Origin: *");header("Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept");if($_SERVER['REQUEST_METHOD'] == 'POST' && empty($_POST)) $_POST = json_decode(file_get_contents('php://input'), true);require_once TO_ROOT . "system/core.php";$data = HCStudio\Util::getVarFromPGS(); #actionif(!ob_start("ob_gzhandler")){	ob_start();	$data['gzip'] = false;} else $data['gzip'] = true;$UserLogin = new Welcome\UserLogin;if(!$UserLogin->_loaded){	if($data['email'])	{		if($data['nickname'])		{			if($data['password'])			{				if($UserLogin->isUniqueMail($data['email']))				{					$data['password'] = sha1($data['password']);					$UserLogin->email = $data['email'];					$UserLogin->password = $data['password'];					$UserLogin->nick_name = $data['nickname'];					$UserLogin->names = $data['nickname'];					$UserLogin->signup_date = time();										if($UserLogin->save())					{						$UserLogin->company_id = $UserLogin->getId();						if($UserLogin->save())						{							if($UserLogin->login($UserLogin->mail,$UserLogin->password))							{								$data['s'] = 1;								$data['r'] = 'LOGGED_OK';								} else {								$data['s'] = 0;								$data['r'] = 'NOT_LOGGED';							}						} else {							$data['s'] = 0;							$data['r'] = 'NOT_UPDATE';						}					} else {						$data['s'] = 0;						$data['r'] = 'NOT_SAVED';						}				}else{					$data['s'] = 0;					$data['r'] = 'USER_ALREADY_EXIST';										}			}else			{				$data['s'] = 0;				$data['r'] = 'NOT_PASSWORD';				}		}else		{			$data['s'] = 0;			$data['r'] = 'NOT_NICKNAME';			}		}else{		$data['s'] = 0;		$data['r'] = 'NOT_MAIL';		}} else {	$data['s'] = 0;	$data['r'] = 'LOADED';}function getHtml($registers){	if($registers)	{		foreach ($registers as $key => $value) {			$html.='<div class="col-md-12"> Nick name '.$value['nick_name'].'</div>';			$html.='<div class="col-md-12"> Nombre '.$value['names'].'</div>';		}		return $html;	} }echo json_encode($data); ?>